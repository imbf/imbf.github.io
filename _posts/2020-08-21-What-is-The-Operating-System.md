---
layout: post
title:  "[Operating System - Chapter 1] 운영체제란 무엇인가?"
date:   2020-08-21
author: Green Frog Developer
categories: Computer-Science(CS)
tags: Operating-System OS CS Computer
---

이 포스팅은 공룡책 알려진 Operating System Concepts의 1장을 공부하면서 정리한 포스팅이다.

---

## 1.1 운영체제란 무엇인가?

---

### 운영체제가 할 일 (What Operating Systems Do)

컴퓨터 시스템은 다음 그림처럼 대게 네 가지 구성요소인 **하드웨어, 운영체제, 응용 프로그램, 사용자**로 구분할 수 있다.

<img src="/assets/computer-science/what-is-the-operating-system-1.png" style="width:30%">

**운영체제는 다양한 사용자를 위해 다양한 응용 프로그램 간의 하드웨어 사용을 제어하고 조종한다.**

운영체제는 항상 실행 중인 **커널(Kernel)**과 응용 프로그램 개발을 쉽게 하고 기능을 제공하는 미들웨어 프레임워크 및 시스템 실행 중에 시스템 관리하는데 도움이 되는 **시스템 프로그램(System Program)**이 포함된다.

> 일반적으로 항상 실행되는 프로그램을 **커널(Kernel)**이라고 한다,

---

### 1.2 컴퓨터 시스템의 구성 (Computer System Organization)

현대의 범용 컴퓨터 시스템은 하나 이상의 CPU와 구성요소와 공유 메모리 사이의 액세스를 제공하는 **공통 버스(bus)**를 통해 연결된 여러 장치 컨트롤러로 구성된다.

<img src="/assets/computer-science/what-is-the-operating-system-2.png" style="width:100%">

일반적으로 운영체제에는 각 장치 컨트롤러마다 **장치 드라이버**가 있다. 이 장치 드라이버는 장치 컨트롤러의 작동을 잘 알고 있고 나머지 운영체제에 장치에 대한 일관된 **인터페이스(명세)를 제공**한다. CPU와 장치 컨트롤러는 병렬로 실행되어 <u>메모리 사이클을 놓고 경쟁</u>한다.

> **장치 드라이버/제어기 또는 디바이스 드라이버**는 특정 하드웨어나 장치를 제어하기 위한 <u>커널의 일부분으로 동작하는 프로그램</u>이다.
>
> **컴퓨터를 구성하는 다양한 입출력 장치마다 각각 장치드라이버가 프로그램 되어 커널에 통합되어 실행된다.**
>
> 높은 수준의 컴퓨터 프로그램들이 컴퓨터 하드웨어 장치와 상호 작용하기 위해 만들어진 하나의 컴퓨터 프로그램이다.

#### 1.2.1 인터럽트 (Interrupts)

하드웨어는 어느 순간이든 시스템 버스를 통해 CPU에 신호를 보내 **인터럽트**를 발생시킬 수 있다.

CPU가 인터럽트 되면 CPU는 하던 일을 중단하고 즉시 고정된 위치로 실행을 옮긴다. 이러한 고정된 위치는 일반적으로 **인터럽트를 위한 서비스 루틴**이 위치한 시작 주소를 가지고 있다. 그리고 인터럽트 서비스 루틴이 실행된다. 인터럽트 서비스 루틴이 실행이 완료되면, CPU는 **인터럽트 되었던 연산을 재개**한다. 다음의 그림은 인터럽트 연산의 시간 일정이다.

<img src="/assets/computer-science/what-is-the-operating-system-3.png" style="width:100%">

일반적으로 인터럽트 서비스 루틴의 주소가 들어 있는 포인터 테이블은 하위 메모리(첫 100개 정도의 위치)에 저장된다.

장치 컨트롤러가 인터럽트 요청 라인에 신호를 선언하여 인터럽트를 **발생(raise)**시키고 CPU는 인터럽트를 **포착(catch)**하여 인터럽트 핸들러로 **디스패치(dispatch)**하고 핸들러는 장치를 서비스하여 인터럽트를 **지운다(clear)**. 이 기본 인터럽트 기법은 **비동기 이벤트에 CPU가 대응**할 수 있게 한다.

인터럽트는 **마스크 불가능 인터럽트(nonmaskable interrupt)**와 **마스킹 가능(maskable interrupt)** 인터럽트로 나뉜다.

#### 1.2.2 저장장치 구조 (Storage Structure)

CPU는 메모리에서만 명령을 적재할 수 있으므로 실행하려면 **프로그램을 먼저 메모리에 적재**해야 한다.

범용 컴퓨터는 프로그램 대부분을 **메인 메모리(Random-Access Memory : RAM)**라 불리는 재기록 가능한 메모리에서 가져온다.

모든 형태의 메모리는 바이트의 배열을 제공한다. 각 바이트는 자신의 주소를 가지고 있다. 상호 작용은 특정 메모리 주소들에 대한 일련의 적재(load), 또는 저장(store)명령을 통하여 이루어진다.

대부분의 컴퓨터 시스템은 메인 메모리의 확장으로 **보조저장장치**를 제공한다. 보조저장장치의 주요 요건은 대량의 데이터를 영구히 보존할 수 있어야 한다는 점이다. 가장 일반적인 보조저장장치는 <u>하드 디스크 드라이브(HDD)와 비휘발성 메모리(NVM)</u>로, 프로그램과 데이터 모두를 위한 저장소를 제공한다.

대부분의 프로그램은 메모리에 적재될 때까지 보조저장 장치를 사용한다. 보조저장장치는 메인 메모리보다 훨씬느리기 때문에, 보조저장장치의 올바른 관리는 컴퓨터 시스템에서 매우 중요하다.

다른 장치에 저장된 자료의 백업 사본을 저장하기 위해 특수 목적으로만 사용하기에 매우 느리고 충분히 큰 장치를 **3차 저장장치**라고 한다.

다양한 저장장치 시스템은 저장 용량 및 액세스 시간에 따라 다음 그림과 같이 계층 구조로 구성될 수 있다.

<img src="/assets/computer-science/what-is-the-operating-system-4.png" style="width:100%">

**캐시**는 두 구성요소 간에 액세스 시간이나 전송 속도의 차이가 큰 경우 성능을 향상하기 위해 설치할 수 있다.

#### 1.2.3 입출력 구조 (I/O Structure)

운영체제 코드의 상당 부분은 시스템의 안정성과 성능에 대한 중요성과 장치의 다양한 특성으로 인해 **I/O 관리**에 할애된다.

인터럽트 구동 I/O의 형태는 소량의 데이터를 이동하는 데는 좋지만 NVS(비휘발성 저장장치) I/O와 같은 대량 데이터 이동에 사용될 때 **높은 오버헤드**를 유발할 수 있다. 이 문제를 해결하기 위해서 **Direct Memory Access(DMA)**가 사용된다.

<u>장치에 대한 버퍼 및 포인터, 입출력 카운트를 세팅한 후 장치 제어기는 CPU의 개입 없이 메모리로부터 자신의 버퍼 장치로 또는 버퍼로부터 메모리로 데이터 블록 전체를 전송한다.</u> 이 경우 <u>블록 전송이 완료될 때마다 인터럽트가 발생</u>한다.

아래의 그림은 DMA를 사용하는 현대 컴퓨터의 작동방식에 대해서 설명한다.

<img src="/assets/computer-science/what-is-the-operating-system-5.png" style="width:100%">

몇몇 고가의 시스템은 버스 대신에 **스위치 구조**를 사용한다. 이러한 시스템에서는 공유 버스를 사용하기 위한 사이클을 경쟁하지 않고 다수의 구성요소가 다른 구성요소들과 동시에 통신하는 것이 가능하다. 이 경우 DMA의 사용은 더욱 효과적이다.

---

### 1.3 컴퓨터 시스템 구조 (Computer SYstem Architecture)

컴퓨터 시스템은 사용된 범용 처리기의 수에 따라 분류 가능한 다양한 방식으로 구성될 수 있다.

#### 1.3.1 단일 처리기 시스템 (Single Processor System)

**Single Processor System이란 하나의 Processor를 포함하는 컴퓨터 시스템을 말한다.**

Single Processor System은 일반적으로 단일 처리 코어를 가진 범용 CPU가 하나만 있는 단일 프로세서 시스템의 경우가 대부분이다.

> **코어**는 명령을 실행하고 로컬로 데이터를 저장하기 위한 레지스터를 포함하는 구성요소이다.

#### 1.3.2 다중 처리기 시스템 (Multi Processor Systems)

**Multi Processor System 이란 두 개 이상의 Processor를 포함하는 컴퓨터 시스템을 말한다.**

다음 그림은 단일 코어 CPU가 있는 두 개의 프로세서로 구성된 시스템을 보여준다.

<img src="/assets/computer-science/what-is-the-operating-system-6.png" style="width:100%">

프로세서는 컴퓨터 버스 및 때때로 클록, 메모리 및 주변 장치를 공유한다.

Multi Processor system의 주요 장점은 **처리량(Throughput)증가** 이다. 즉, 프로세서 수를 늘리면 더 적은 시간에 더 많은 작업을 수행할 수 있다.

가장 일반적인 다중 처리기 시스템은 각 **피어 CPU 프로세스가 운영체제 기능 및 사용자 프로세스를 포함한 모든 작업을 수행하는 SMP(symmetric multiprocessing)**를 사용한다. 이 모델의 장점은 성능을 크게 저하하지 않으면서 N개의 프로세스를 실행할 수 있다. 그러나 CPU가 독립적이기 때문에 하나는 유휴 상태이고 다른 하나는 과부하가 걸려서 비효율적일 수 있다.

MultiProcessor의 정의는 시간이 지남에 따라 발전해 왔으며 이제는 여러개의 컴퓨팅 코어가 단일 칩에 상주하는 **다중 코어**시스템을 포함한다. Processor 내의 통신이 Processor 간의 통신보다 빠름으로 다중 코어 시스템은 단일 코어를 가지는 여러 Processor보다 효율적일 수 있다.

> **컴퓨터 시스템 구성요소 정의**
>
> - **CPU** - 명령을 실행하는 하드웨어
> - **Processor** - 하나 이상의 CPU를 포함하는 물리적 칩
> - **Core** - CPU의 기본 계산 단위
> - **MultiCore** - 동일한 CPU에 여러 컴퓨팅 코어를 포함함.
> - **MultiProcessor** - 여러 프로세서를 포함함.

Multi Processor에 작고 빠른 로컬 버스를 통해 액세스 되는 자체 로컬 메모리를 제공하고 모든 CPU가 **공유 시스템 연결**로 연결되어 모든 CPU가 하나의 물리 주소 공간을 공유하는 **NUMA(non-uniform memory access)**라고 하는 이 방법은 CPU가 로컬 메모리에 액세스 할 때 빠를 뿐만 아니라 시스템 상호 연결에 대한 경합도 없다는 장점이 있다.

NUMA Multi Processor Structure은 다음과 같다.

<img src="/assets/computer-science/what-is-the-operating-system-7.png" style="width:70%">

하지만 NUMA 시스템의 잠재적 단점은 CPU가 시스템 상호 연결을 통해 원격 메모리에 액세스해야 할 때 지연 시간이 증가하여 성능 저하가 발생할 수 있다는 점이다.












